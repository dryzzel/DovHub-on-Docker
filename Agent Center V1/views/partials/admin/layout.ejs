<div id="adminScreen" class="screen">
    <div class="admin-layout">
        <!-- Sidebar Navigation -->
        <aside class="admin-sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <i data-feather="shield"></i> DOV Admin
                </div>
            </div>
            <nav class="sidebar-menu">
                <button class="nav-item active" onclick="showAdminView('dashboard')" id="nav-dashboard">
                    <i data-feather="grid"></i> Dashboard
                </button>
                <button class="nav-item" onclick="showAdminView('leads')" id="nav-leads">
                    <i data-feather="layers"></i> Lead Management
                </button>
                <button class="nav-item" onclick="showAdminView('users')" id="nav-users">
                    <i data-feather="users"></i> User Management
                </button>
                <button class="nav-item" onclick="showAdminView('uploads')" id="nav-uploads">
                    <i data-feather="upload-cloud"></i> Data Uploads
                </button>
                <button class="nav-item" onclick="showAdminView('ringcentral')" id="nav-ringcentral">
                    <i data-feather="phone-forwarded"></i> RingCentral
                </button>
            </nav>
            <div class="button-group" style="margin-top: auto;">
                <button id="adminRefreshBtn" class="small-btn"><i data-feather="refresh-cw"></i> Refresh Data</button>
                <button id="adminLogoutBtn" class="small-btn danger-btn"><i data-feather="log-out"></i> Logout</button>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="admin-content">
            <!-- VIEW: DASHBOARD (Overview) -->
            <div id="admin-view-dashboard" class="admin-view">
                <div class="dashboard-header">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <div>
                            <h1 class="dashboard-title">Dashboard Overview</h1>
                            <p class="dashboard-date" id="currentDateDisplay">Today</p>
                        </div>
                        <div class="refresh-info" id="lastUpdate">Last update: Never</div>
                    </div>
                </div>

                <!-- Global KPI Cards -->
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h4 class="stat-title">Total Calls (Today)</h4>
                        <p class="stat-value" id="globalTotalCalls">0</p>
                    </div>
                    <div class="dashboard-card">
                        <h4 class="stat-title">Contact Rate</h4>
                        <p class="stat-value" id="globalContactRate">0%</p>
                    </div>
                    <div class="dashboard-card">
                        <h4 class="stat-title">Lead Conversion</h4>
                        <p class="stat-value" id="globalConversionRate">0%</p>
                    </div>
                </div>

                <div class="dashboard-grid" style="grid-template-columns: 2fr 1fr;">
                    <!-- Agent Performance Chart -->
                    <div class="dashboard-card">
                        <h3 class="section-title"><i data-feather="bar-chart"></i> Agent Performance</h3>
                        <div style="width: 100%; height: 300px;">
                            <canvas id="agentPerformanceChart"></canvas>
                        </div>
                    </div>

                    <!-- Global Disposition Summary -->
                    <div class="dashboard-card">
                        <h3 class="section-title"><i data-feather="pie-chart"></i> Disposition Summary</h3>
                        <div id="dispositionStatsList" class="stats-grid" style="grid-template-columns: 1fr;"></div>
                    </div>
                </div>

                <!-- Leaderboard -->
                <div class="dashboard-card">
                    <h3 class="section-title"><i data-feather="award"></i> Top Performers Today</h3>
                    <div id="leaderboardContainer" class="users-grid"></div>
                </div>
            </div>

            <!-- VIEW: LEAD MANAGEMENT -->
            <div id="admin-view-leads" class="admin-view" style="display: none;">
                <div class="dashboard-header">
                    <h1 class="dashboard-title">Lead Management</h1>
                    <p class="dashboard-date">Filter, Assign, and Manage Leads</p>
                </div>

                <div class="dashboard-card">
                    <h2 class="section-title"><i data-feather="filter"></i> Filters</h2>
                    <div class="form-grid">
                        <div>
                            <label class="form-label">Search</label>
                            <input type="text" id="lead-filter-search" class="form-input" placeholder="Name or Phone">
                        </div>
                        <div>
                            <label class="form-label">Custom ID</label>
                            <select id="lead-filter-custom-id" class="form-input">
                                <option value="">All Custom IDs</option>
                            </select>
                        </div>
                        <div>
                            <label class="form-label">Start Date</label>
                            <input type="date" id="lead-filter-start-date" class="form-input">
                        </div>
                        <div>
                            <label class="form-label">End Date</label>
                            <input type="date" id="lead-filter-end-date" class="form-input">
                        </div>
                        <div>
                            <label class="form-label">Filter by Disposition</label>
                            <div class="custom-dropdown" id="disposition-dropdown">
                                <button class="form-input" id="disposition-dropdown-btn"
                                    style="text-align: left; display: flex; justify-content: space-between; align-items: center;">
                                    <span>All Dispositions</span>
                                    <i data-feather="chevron-down" style="width: 16px; height: 16px;"></i>
                                </button>
                                <div class="dropdown-content" id="disposition-dropdown-content"></div>
                            </div>
                        </div>
                        <div>
                            <label class="form-label">Filter by Agent</label>
                            <select id="lead-filter-agent" class="form-input">
                                <option value="">All Agents</option>
                                <option value="unassigned">Not Assigned</option>
                            </select>
                        </div>
                        <div>
                            <label class="form-label">Filter by Product</label>
                            <select id="lead-filter-product" class="form-input">
                                <option value="">All Products</option>
                            </select>
                        </div>
                        <div>
                            <label class="form-label">Filter by List</label>
                            <select id="lead-filter-list" class="form-input">
                                <option value="">All Lists</option>
                                <option value="Dispos Manual">Dispos Manual</option>
                                <option value="Prestige">Prestige</option>
                                <option value="Locktight">Locktight</option>
                                <option value="FHIA">FHIA</option>
                                <option value="Clean Energy">Clean Energy</option>
                                <option value="Orphan">Orphan</option>
                            </select>
                        </div>
                        <div>
                            <label class="form-label">Filter by Prev. Company</label>
                            <select id="lead-filter-prev-company" class="form-input">
                                <option value="">All Companies</option>
                            </select>
                        </div>
                        <div>
                            <label class="form-label">Filter by Language</label>
                            <select id="lead-filter-language" class="form-input">
                                <option value="">All Languages</option>
                            </select>
                        </div>
                        <div>
                            <label class="form-label">Sort by Date</label>
                            <select id="lead-sort-order" class="form-input">
                                <option value="desc">Newest First</option>
                                <option value="asc">Oldest First</option>
                            </select>
                        </div>
                        <div>
                            <label class="form-label">Rows per page</label>
                            <select id="lead-rows-per-page" class="form-input">
                                <option value="50">50</option>
                                <option value="100">100</option>
                                <option value="200">200</option>
                                <option value="500">500</option>
                                <option value="1000">1000</option>
                                <option value="custom">Custom</option>
                            </select>
                        </div>
                        <div
                            style="display: flex; gap: 10px; align-items: center; justify-content: space-between; grid-column: 1 / -1; width: 100%;">
                            <button id="filter-leads-btn" class="login-btn" style="width: 200px;"
                                onclick="loadAllLeads()"><i data-feather="filter"></i>
                                Filter</button>
                            <button id="deduplicate-leads-btn" class="login-btn danger-btn"
                                style="width: auto; padding: 0 16px;" title="Remove Duplicates"
                                onclick="document.getElementById('deleteOptionsModal').style.display = 'flex'; feather.replace();"><i
                                    data-feather="trash-2"></i> Delete Options</button>
                        </div>
                    </div>

                    <div id="all-leads-container" style="margin-top:20px;">
                        <div class="form-grid"
                            style="margin-top:10px; border-top: 1px solid var(--border); padding-top: 10px;">
                            <div>
                                <label class="form-label">Reassign Selected to</label>
                                <select id="reassign-lead-agent" class="form-input"></select>
                            </div>
                            <button id="reassign-selected-leads-btn" class="login-btn secondary-btn"
                                style="margin-bottom: 0;" onclick="reassignSelectedLeads()"><i
                                    data-feather="shuffle"></i> Reassign</button>
                        </div>
                        <div id="all-leads-list" style="margin-top:10px;">
                            <p style="text-align: center; color: var(--subtext);">Filter to display leads</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: USER MANAGEMENT -->
            <div id="admin-view-users" class="admin-view" style="display: none;">
                <div class="dashboard-header">
                    <h1 class="dashboard-title">User Management</h1>
                    <p class="dashboard-date">Manage Agents and Admins</p>
                </div>

                <div class="dashboard-grid" style="grid-template-columns: 1fr 2fr;">
                    <!-- Create User Form -->
                    <div class="dashboard-card" style="height: fit-content;">
                        <h3 class="section-title"><i data-feather="user-plus"></i> Create New User</h3>
                        <div class="form-grid" style="grid-template-columns: 1fr;">
                            <div>
                                <label class="form-label">Username</label>
                                <input type="text" id="newUsername" class="form-input" placeholder="Username">
                            </div>
                            <div>
                                <label class="form-label">Password</label>
                                <input type="password" id="newPassword" class="form-input" placeholder="Password">
                            </div>
                            <div>
                                <label class="form-label">User ID</label>
                                <input type="text" id="newEmail" class="form-input" placeholder="User ID">
                            </div>
                            <button id="createUserBtn" class="login-btn"><i data-feather="plus"></i> Create
                                User</button>
                        </div>
                    </div>

                    <!-- User List -->
                    <div class="dashboard-card">
                        <h3 class="section-title"><i data-feather="users"></i> Active Users</h3>
                        <div id="usersSummary" class="users-grid"
                            style="grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));"></div>
                    </div>
                </div>
            </div>

            <!-- VIEW: DATA UPLOADS -->
            <div id="admin-view-uploads" class="admin-view" style="display: none;">
                <div class="dashboard-header">
                    <h1 class="dashboard-title">Data Uploads</h1>
                    <p class="dashboard-date">Import Leads from CSV</p>
                </div>

                <div class="dashboard-card" style="max-width: 600px; margin: 0 auto;">
                    <h2 class="section-title"><i data-feather="upload-cloud"></i> Upload CSV</h2>
                    <div class="form-grid" style="grid-template-columns: 1fr;">
                        <div>
                            <label class="form-label">Select List</label>
                            <div style="display: flex; gap: 5px;">
                                <select id="upload-list-name" class="form-input" style="flex:1;">
                                    <option value="Dispos Manual">Dispos Manual</option>
                                    <option value="Prestige">Prestige</option>
                                    <option value="Locktight">Locktight</option>
                                    <option value="FHIA">FHIA</option>
                                    <option value="Clean Energy">Clean Energy</option>
                                    <option value="Orphan">Orphan</option>
                                </select>
                                <button id="add-custom-list-btn" class="login-btn secondary-btn"
                                    style="width: auto; padding: 0 10px;" title="Add new list name">+</button>
                            </div>
                        </div>
                        <div>
                            <label class="form-label">Custom ID <span style="color:var(--danger)">*</span></label>
                            <input type="text" id="upload-custom-id" class="form-input"
                                placeholder="Internal Batch ID (Required)">
                        </div>
                        <div>
                            <label class="form-label">CSV File</label>
                            <input type="file" id="upload-csv-file" class="form-input" accept=".csv">
                        </div>
                        <div style="display: flex; gap: 10px; align-items: center; margin-top: 20px;">
                            <button id="upload-leads-btn" class="login-btn" style="flex: 1;"><i
                                    data-feather="upload"></i>
                                Upload</button>
                            <button id="upload-info-btn" class="login-btn secondary-btn" style="width: auto;"
                                title="Important Info"><i data-feather="info"></i></button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: RINGCENTRAL METRICS -->
            <div id="admin-view-ringcentral" class="admin-view" style="display: none;">
                <div class="dashboard-header">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h1 class="dashboard-title">RingCentral Analytics</h1>
                            <p class="dashboard-date">Call Performance Metrics</p>
                        </div>
                    </div>
                </div>

                <!-- Agent Activity Section -->
                <div class="dashboard-card">
                    <h3 class="section-title"><i data-feather="activity"></i> Agent Activity Details</h3>

                    <div style="display: flex; gap: 12px; margin-bottom: 20px; align-items: center; flex-wrap: wrap;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <i data-feather="calendar" style="width: 18px; height: 18px; color: var(--accent);"></i>
                            <label for="rcDateInput"
                                style="color: var(--text); font-weight: 600; font-size: 0.9em;">Select Date:</label>
                        </div>
                        <input type="date" id="rcDateInput" class="form-input"
                            style="width: auto; max-width: 200px; flex: 0 0 auto;">
                        <button id="rcUpdateBtn" class="small-btn"
                            style="background: var(--accent); color: white; border: none; padding: 10px 20px; display: flex; align-items: center; gap: 8px; font-weight: 600;">
                            <i data-feather="refresh-cw" style="width: 16px; height: 16px;"></i>
                            <span>Update</span>
                        </button>
                    </div>

                    <div style="overflow-x: auto;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th style="border-top-left-radius: 8px;">Agent</th>
                                    <th>First Call</th>
                                    <th>Last Call</th>
                                    <th style="border-top-right-radius: 8px; text-align: center;">Total Calls</th>
                                </tr>
                            </thead>
                            <tbody id="rcAgentActivityTable">
                                <tr>
                                    <td colspan="4" class="muted">Select a date and click Update</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </main>
    </div>
</div>